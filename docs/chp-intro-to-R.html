<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>chp-intro-to-R.knit</title>

<script src="site_libs/header-attrs-2.19/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="computer-setup.html">Computer Setup</a>
</li>
<li>
  <a href="NEON-data-intro.html">NEON Data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Chapters
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="00-module-contents.html">Chapter overview</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Core lessons</li>
    <li>
      <a href="chp-computer-navigation.html">1. Computer navigation</a>
    </li>
    <li>
      <a href="chp-intro-to-R.html">2. Intro to R</a>
    </li>
    <li>
      <a href="chp-spreadsheets.html">3. Spreadsheets</a>
    </li>
    <li>
      <a href="chp-data-structures.html">4. Data structures</a>
    </li>
    <li>
      <a href="chp-functions.html">5. Functions</a>
    </li>
    <li>
      <a href="chp-ggplot2-part1.html">6. Intro to ggplot2</a>
    </li>
    <li>
      <a href="chp-program-flow.html">7. Program flow</a>
    </li>
    <li>
      <a href="chp-ggplot2-part2.html">8. More ggplot2</a>
    </li>
    <li>
      <a href="chp-tidyverse-basics.html">9. Tidy data</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Supplemental lessons</li>
    <li>
      <a href="chp-rmarkdown.html">A. Rmarkdown</a>
    </li>
    <li>
      <a href="chp-geospatial-raster.html">B. Raster data</a>
    </li>
    <li>
      <a href="chp-openrefine.html">C. OpenRefine</a>
    </li>
    <li>
      <a href="chp-git.html">D. Git</a>
    </li>
  </ul>
</li>
<li>
  <a href="exercises-guide.html">Exercises</a>
</li>
<li>
  <a href="download-student-RStudio-project.html">RStudio Workbook</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<div id="chapter-2.-intro-to-r-and-rstudio"
class="section level1 tabset">
<h1 class="tabset">Chapter 2. Intro to R and RStudio</h1>
<div id="overview" class="section level2">
<h2>Overview</h2>
<blockquote>
<p>Why should you learn how to use R?</p>
<p>Because it can do almost anything you need as a scientist:</p>
<p>R can:</p>
<ul>
<li>do computations</li>
<li>manipulate data</li>
<li>access files on your computer or the internet</li>
<li>make graphs</li>
<li>create documents</li>
<li>create apps</li>
<li>almost anything… though it is not always the best tool for every
job.</li>
</ul>
</blockquote>
<p>R is widely used in the scientific community and will always be free
to use. R is also <em>open source</em>- this means that anyone can see,
modify and distribute the code for the program. The fact that R is open
source means that thousands of users have contributed add-on packages
that increase the functionality of the base R program. If there’s an
analysis you want to do or a graph you want to make, someone has
probably made a package for it. All you have to do is find it and use
it.</p>
<p>R also makes it easier to practice <a
href="https://www.unesco.org/en/open-science">open science</a> by making
your scientific analyses transparent and reusable. This is because
analyses are saved as code rather than a series of clicks through a user
interface (like spreadsheet software). If you share this code and your
data with someone, they will be able to reproduce your analyses with a
single click.</p>
<p>We’re going to learn some of the fundamentals of the R programming
language and writing our first code script. We’ll be using RStudio: a
free, open-source R Integrated Development Environment (IDE). It
provides a built-in editor, works on all platforms (including on
servers) and provides many advantages such as integration with version
control and project management. We’ll learn some of the basics for
working with R code in RStudio.</p>
<div id="what-we-will-learn" class="section level3">
<h3>What we will learn</h3>
<p>In this lesson learners will:</p>
<ul>
<li>discover why so many scientists use R</li>
<li>describe the contents of the windows in an RStudio session</li>
<li>install and load packages in R</li>
<li>write and save a code script in a project folder</li>
<li>read and view tabular data from a file</li>
<li>use the console for mathematical calculations</li>
<li>state the rules for assigning variables</li>
<li>work with vectors</li>
<li>learn how to get help and troubleshoot error messages</li>
</ul>
<div id="key-terms-commands" class="section level4">
<h4>Key Terms &amp; Commands</h4>
<ul>
<li>command line</li>
<li>GUI (graphical user interface)</li>
<li>script</li>
<li>function and argument</li>
<li>vector</li>
<li>warnings vs. errors</li>
<li>ways to make vectors: <code>c()</code>, <code>seq()</code>,
<code>:</code>, and <code>rep()</code></li>
<li>variable assignment: <code>&lt;-</code> and <code>=</code></li>
<li><code>help()</code> or <code>?</code></li>
<li><code>ls()</code> and <code>rm()</code></li>
<li><code>read.csv()</code></li>
<li><code>getwd()</code> and <code>setwd()</code></li>
<li><code>$</code></li>
<li><code>head()</code>, <code>nrow()</code>, <code>ncol()</code> and
<code>names()</code></li>
<li><code>range()</code>, <code>mean()</code>, and
<code>table()</code></li>
</ul>
</div>
</div>
<div id="prerequisites" class="section level3">
<h3>Prerequisites</h3>
<p>Check that you have the latest version of R and RStudio installed on
your machine. This is important, as some packages may not install
correctly (or at all) if R is not up to date. For instructions on
installing (or updating) R and RStudio, please see <a
href="computer-setup.html">Computer Setup</a>.</p>
<p>Once R and RStudio are installed, you will also need to set up the
Student Workbook that accompanies this text as an RStudio project.
Instructions are in the first exercise from <a
href="chp-computer-navigation.html">Navigating your computer</a>.</p>
</div>
</div>
<div id="lesson" class="section level2">
<h2>Lesson</h2>
<div id="welcome-back-to-rstudio" class="section level3">
<h3>Welcome (back) to RStudio!</h3>
<p>In <a href="%22chp-computer-navigation.html%22">Computer
navigation</a> we used RStudio to learn how to work with files on a
computer, but didn’t really learn much about what RStudio actually is or
how it is related to the R program.</p>
<p>Let’s clarify the difference between R and RStudio:</p>
<ul>
<li>R is a program that you installed on your computer that allows you
to write code in the <strong>R programming language</strong>.</li>
<li>R is a command-line program that executes code one line at a time to
produce output (more on this later).</li>
<li>R code is usually written and saved in files called
<strong>scripts</strong> which you can customize to do almost
anything.</li>
<li>RStudio is a program that allows you to write R code and test it out
at the same time (which is why it is called an integrated development
environment). It provides a <strong>G</strong>raphical
<strong>U</strong>ser <strong>I</strong>nterface (GUI) that makes it
easier to interact with R and develop R code.</li>
</ul>
<p>We will start by opening the student workbook RStudio project that
accompanies this text. To open an RStudio project, use your computer’s
file browser to navigate to the R-course-NEON-workbook folder you
downloaded. Inside this folder, double click on the
R-course-NEON-workbook.Rproj file (see the lesson: <a
href="chp-computer-navigation.html">Computer navigation</a>)</p>
<p><strong>Basic layout</strong></p>
<p>When you first open RStudio, you will be greeted by three panels:</p>
<ul>
<li>The interactive R console/Terminal (entire left)</li>
<li>Environment/History/Connections (tabbed in upper right)</li>
<li>Files/Plots/Packages/Help/Viewer (tabbed in lower right)</li>
</ul>
<p>If you opened the R-course-NEON-workbook project then your RStudio
session should look like this:</p>
<div class="float">
<img src="images/01-rstudio.png" alt="RStudio layout" />
<div class="figcaption">RStudio layout</div>
</div>
<p>If you’re having trouble seeing the different windows, RStudio has
several <a
href="https://support.posit.co/hc/en-us/articles/360044226673-RStudio-Accessibility-Features">accessibility
features</a> that allow you to change the size of text and simplify the
layout. You may want to customize your setup now.</p>
<p>In <a href="chp-computer-navigation.html">Computer navigation</a> we
learned about the Terminal and File panels. In this lesson we’re going
to start working in the R console to learn about some of the basic
functionality of R. Notice that the Console and Terminal tabs share the
same panel. R console and Console are used interchangeably to refer to
the same panel. Once we start learning more complex code, we will open
the Source panel and create an R script for saving the code that we
write.</p>
<p>The first thing you will see in the R console is a bunch of
information, followed by a “&gt;” and a blinking cursor. This is a
<strong>command-line interface</strong>; it reads and evaluates one line
of code at a time, printing out any results of each line to the same
console window as it goes. If you type in commands at the command line,
R tries to execute them, and then returns a result.</p>
<p>For the first part of this lesson, you should type any code that you
see in grey boxes into the command line in the R console and then press
enter.</p>
<pre class="r"><code>type this into the command line</code></pre>
<p>This document will show you the expected output of each command in a
white boxes below like this:</p>
<pre><code>[1] expected code output</code></pre>
<p>Or, the expected output may show up directly below the line of code
and be preceded by a <code>[1]</code>:</p>
<pre class="r"><code>type this into the command line
[1] expected code output</code></pre>
<p>Let’s start by demonstrating some of the basic functionality of
R.</p>
</div>
<div id="what-can-r-do" class="section level3">
<h3>What can R do?</h3>
<p>As mentioned in the introduction, R can do almost anything, although
it is not always the best tool for every job.</p>
<div id="arithmetic-and-calculations" class="section level4">
<h4>Arithmetic and calculations</h4>
<p>The simplest thing you could do with R is to do arithmetic:</p>
<pre class="r"><code>1 + 100</code></pre>
<pre><code>[1] 101</code></pre>
<p>R will print out the answer, with a preceding “[1]” because this is
the first line of output.</p>
<p>If you type in an incomplete command, R will wait for you to complete
it. For example:</p>
<pre class="r"><code>1 +</code></pre>
<pre><code>+</code></pre>
<p>Any time you press <kbd>Enter</kbd> and the R session shows a “+”
instead of a “&gt;”, it means that the console is waiting for you to
complete the command. You can either keep typing the rest of the
command:</p>
<pre class="r"><code>1 +
100</code></pre>
<pre><code>[1] 101</code></pre>
<p>or cancel what you were doing. If you want to cancel a command you
can type <kbd>Esc</kbd> and RStudio will give you back the “&gt;”
prompt.</p>
<p>Canceling a command isn’t only useful for stopping incomplete
commands: you can also use it to tell R to stop running code (for
example if it’s taking much longer than you expect), or to get rid of
the code you’re currently writing.</p>
<p>When using R as a calculator, the order of operations is the same as
you would have learned in math class.</p>
<p>From highest to lowest precedence:</p>
<ul>
<li>Parentheses: <code>(</code>, <code>)</code></li>
<li>Exponents: <code>^</code> or <code>**</code></li>
<li>Multiply: <code>*</code></li>
<li>Divide: <code>/</code></li>
<li>Add: <code>+</code></li>
<li>Subtract: <code>-</code></li>
</ul>
<pre class="r"><code>3 + 5 * 2</code></pre>
<pre><code>[1] 13</code></pre>
<p>Use parentheses to group operations in order to force the order of
evaluation if it differs from the default, or to make clear what you
intend.</p>
<pre class="r"><code>(3 + 5) * 2</code></pre>
<pre><code>[1] 16</code></pre>
<p>Really small or large numbers get a scientific notation:</p>
<pre class="r"><code>2/10000</code></pre>
<pre><code>[1] 2e-04</code></pre>
<p>Which is shorthand for “multiplied by <code>10^XX</code>”. So
<code>2e-4</code> is shorthand for <code>2 * 10^(-4)</code>.</p>
<p>You can write numbers in scientific notation too:</p>
<pre class="r"><code>5e3  </code></pre>
<pre><code>[1] 5000</code></pre>
<p>R has many built in mathematical functions. To use a function, we can
type its name, followed by open and closing parentheses (just like
functions in math!). Functions take <strong>arguments</strong> as
inputs- anything we type inside the parentheses of a function is
considered an argument. Depending on the function, the number of
arguments can vary from none to multiple. For example:</p>
<pre class="r"><code>getwd() # returns an absolute file path of the current working directory</code></pre>
<p>doesn’t require an argument, whereas for the next set of mathematical
functions we will need to supply the function a value in order to
compute the result.</p>
<pre class="r"><code>sin(1)  # trigonometry functions
[1] 0.841471</code></pre>
<pre class="r"><code>log(1)  # natural logarithm
[1] 0</code></pre>
<pre class="r"><code>log10(10) # base-10 logarithm
[1] 1</code></pre>
<pre class="r"><code>exp(0.5) # e^(1/2)
[1] 1.648721</code></pre>
<p>Some functions take multiple arguments that are separated by
commas.</p>
<pre class="r"><code>sum(1, 2, 3) # adds all numeric arguments together
[1] 6</code></pre>
<p>Did you notice the text at the end of each line of code above? This
text is called a <strong>comment</strong> because it is preceded by a
hash character (<code>#</code>). This character tells R to ignore
anything that comes after it on the same line. Since this text is not
evaluated we can use it to make notes about what the code does. You do
not need to type the comments into the command line to run the code.</p>
<div class="challenge">
<p>What should be the output for each of these commands?</p>
<pre class="r"><code>log(exp(3 + 3)) 
2e-1 + 5</code></pre>
<details>
<summary>
<strong>Solution:</strong>
</summary>
<div class="solution">
<pre class="r"><code>log(exp(3 + 3)) 
[1] 6
2e-1 + 5
[1] 5.2</code></pre>
</div>
</details>
</div>
<p><br></p>
<div class="challenge">
<p>What do the values <code>NA</code> and <code>NULL</code> mean?</p>
<p>Run each of these commands and try to guess what is happening.</p>
<pre class="r"><code>sum(3, NA)
sum(3, NULL)</code></pre>
<details>
<summary>
<strong>Solution:</strong>
</summary>
<div class="solution">
<pre class="r"><code>sum(3, NA)
[1] NA
sum(3, NULL)
[1] 3</code></pre>
<p><code>NA</code> is a special placeholder value that means that data
is missing. <code>NULL</code> is a special value that means something
does not exist. Thus, arithmetic with <code>NA</code> will by default
give a <code>NA</code> result because missing values are values that we
may have tried to collect, but failed to do so. In contrast,
<code>NULL</code> values do not take up any space and are ignored by
default in calculations. We will learn later how to ignore missing
values in calculations.</p>
</div>
</details>
</div>
<p><br></p>
</div>
<div id="work-with-stored-values-in-a-computing-environment"
class="section level4">
<h4>Work with stored values in a computing environment</h4>
<p>The first step toward writing code is to store values for use later.
We can store values using the assignment operator <code>&lt;-</code>,
like this:</p>
<pre class="r"><code>x &lt;- 1/40</code></pre>
<p>Notice that assignment does not print a value. Instead, we stored it
for later in something called a <strong>variable</strong>.
<code>x</code> now contains the <strong>value</strong>
<code>0.025</code>:</p>
<pre class="r"><code>x
[1] 0.025</code></pre>
<p>More precisely, the stored value is a <em>decimal approximation</em>
of this fraction called a <a
href="http://en.wikipedia.org/wiki/Floating_point">floating point
number</a>. The value is stored in an <strong>object</strong> named
<code>x</code> in the environment.</p>
<p>Look for the <code>Environment</code> tab in the top right panel of
RStudio, and you will see that <code>x</code> and its value have
appeared. The variable <code>x</code> can be used in place of a number
in any calculation that expects a number:</p>
<pre class="r"><code>log(x)
[1] -3.688879</code></pre>
<p>Notice also that variables can be reassigned when they already
exist:</p>
<pre class="r"><code>x &lt;- 100</code></pre>
<p><code>x</code> used to contain the value 0.025 and now it has the
value 100. You can see this in the <code>Environment</code> tab in the
upper right panel.</p>
<p>Assignment values can contain the variable being assigned to (watch
what happens to the values of <code>x</code> and <code>y</code> in the
Environment tab):</p>
<pre class="r"><code>x &lt;- x + 1 
y &lt;- x * 2</code></pre>
<p>The right hand side of the assignment can be any valid R expression.
The right hand side is <em>fully evaluated</em> before the assignment
occurs.</p>
<div class="challenge">
<p>What will be the values of <code>y</code> and <code>z</code> after
you run these lines of code in order?</p>
<pre class="r"><code>x &lt;- 10
y &lt;- 2*x
z &lt;- x + y
x &lt;- 20</code></pre>
<details>
<summary>
<strong>Solution:</strong>
</summary>
<div class="solution">
<pre class="r"><code># type the variable names to print out their values
x
[1] 20
y 
[1] 20
z
[1] 30</code></pre>
</div>
</details>
</div>
<p><br></p>
<p>Did you guess correctly? Even though we changed the value of
<code>x</code> in the last line, this does not change the value of
<code>y</code> or <code>z</code> because the values of these two
variables were assigned when <code>x</code> was <code>10</code>. We
would have to run the assignment of <code>y</code> and <code>z</code>
again to update their values based on the new value of
<code>x</code>:</p>
<pre class="r"><code>y &lt;- 2*x
z &lt;- x + y

x
[1] 20
y
[1] 40
z
[1] 60</code></pre>
<div class="callout-trick">
<p>Instead of retyping commands that you want to run again into the
console, use the up arrow key at the command prompt. Each time you press
the up arrow the command line will cycle back through commands you typed
previously. Use the back arrow key to edit the command before running it
again.</p>
</div>
<div class="challenge">
<p>Is R case sensitive?</p>
<p>What happens when you run this code?</p>
<pre class="r"><code>y &lt;- 2*X</code></pre>
<details>
<summary>
<strong>Solution:</strong>
</summary>
<div class="solution">
<pre><code>Error in eval(expr, envir, enclos): object &#39;X&#39; not found</code></pre>
<p>We’ve discovered a very important point about variable names- they
are case sensitive! <code>x</code> is a different variable than
<code>X</code>. Thus, if you try to use a variable that you have not
defined in the environment, R will print out an error message saying
that it can’t find the variable you used.</p>
</div>
</details>
</div>
<p><br></p>
<div class="callout-important">
<p>Variable names can contain letters, numbers, underscores and periods
but no spaces. They must start with a letter or a period followed by a
letter (they cannot start with a number nor an underscore).</p>
</div>
<p>Variables beginning with a period are hidden variables. Different
people use different conventions for long variable names, these
include</p>
<ul>
<li>periods.between.words</li>
<li>underscores_between_words</li>
<li>camelCaseToSeparateWords</li>
</ul>
<p>What you use is up to you, but <strong>be consistent</strong>.</p>
<p>You should also avoid using variable names that are the same as
values or functions in R (e.g., <code>pi</code>, <code>sum</code>,
<code>c</code>, <code>names</code>, <code>data</code>). In general, try
to use a name that is specific to what the variable represents. If
you’re not sure whether a name is used in R, you can use the
<code>?</code> to look it up (more on this later):</p>
<pre class="r"><code>?mean</code></pre>
<pre class="r"><code>?average</code></pre>
<pre><code>No documentation for &#39;average&#39; in specified packages and libraries:
you could try &#39;??average&#39;</code></pre>
<p>If a name already exists for a function, it will open up a Help
window. If the name is available for you to use, then the console will
report that it could not find any documentation.</p>
<p>It is also possible to use the <code>=</code> operator for
assignment:</p>
<pre class="r"><code>x = 1/40</code></pre>
<p>But this is much less common among R users. The most important thing
is to <strong>be consistent</strong> with the operator you use. There
are occasionally places where it is less confusing to use
<code>&lt;-</code> than <code>=</code>, and it is the most common symbol
used in the community. So the recommendation is to use
<code>&lt;-</code>.</p>
<div class="challenge">
<p>Which of the following are valid R variable names?</p>
<pre class="r"><code>min_height
max.height
_age
.mass
MaxLength
min-length
2widths
celsius2kelvin
exp
pi</code></pre>
<details>
<summary>
<strong>Solution:</strong>
</summary>
<div class="solution">
<p>These can be used as R variables: <code>min_height</code>
<code>max.height</code> <code>MaxLength</code>
<code>celsius2kelvin</code></p>
<p>This creates a hidden variable: <code>.mass</code></p>
<p>These cannot be used to create a variable: <code>_age</code>
<code>min-length</code> <code>2widths</code></p>
<p>These should not be used as variable names because they already exist
in R: <code>pi</code> <code>exp</code></p>
</div>
</details>
</div>
<p><br></p>
</div>
<div id="calculations-on-multiple-stored-values-at-once"
class="section level4">
<h4>Calculations on multiple stored values at once</h4>
<p>R can assign multiple values to the same object- one way to do this
is using a <strong>vector</strong>, an ordered list of values that are
of the same data type (e.g. numbers, text, TRUE/FALSE). In <a
href="chp-data-structures.html">Data structures and operations</a> we
will explain in much more detail the different types of data and objects
you can create in R, but for now let’s just explore how R does
arithmetic with vectors.</p>
<p>You can construct a vector using the <code>c()</code> function:</p>
<pre class="r"><code>ages &lt;- c(18, 19, 21, 17)
firstNames &lt;- c(&quot;Sasha&quot;, &quot;Everett&quot;, &quot;Hope&quot;, &quot;Arturo&quot;)

ages
[1] 18 19 21 17
firstNames
[1] &quot;Sasha&quot;   &quot;Everett&quot; &quot;Hope&quot;    &quot;Arturo&quot; </code></pre>
<p>You can also put vectors together using the <code>c()</code>
function:</p>
<pre class="r"><code>c(20, ages, 40)
[1] 20 18 19 21 17 40</code></pre>
<p>To select an element in a list, type the <strong>index</strong> of
the element desired inside square brackets. For example, to select the
second element:</p>
<pre class="r"><code>firstNames[2]
[1] &quot;Everett&quot;</code></pre>
<p>You can select multiple elements at once by typing a vector of
indices inside the square brackets:</p>
<pre class="r"><code>firstNames[c(3, 1)]
[1] &quot;Hope&quot;  &quot;Sasha&quot;</code></pre>
<p>A colon <code>:</code> is a special operator that will create a
vector of integers in order:</p>
<pre class="r"><code>1:4
[1] 1 2 3 4
4:1
[1] 4 3 2 1</code></pre>
<p>To make a vector with any sequence of integers, use the
<code>seq()</code> function:</p>
<pre class="r"><code>seq(1, 10, by = 2)
[1] 1 3 5 7 9
seq(0, 100, by = 10)
 [1]   0  10  20  30  40  50  60  70  80  90 100</code></pre>
<p>To make a vector with repeated values used the <code>rep()</code>
function:</p>
<pre class="r"><code># What is the difference in the output of these two commands?
rep(firstNames, 4)
 [1] &quot;Sasha&quot;   &quot;Everett&quot; &quot;Hope&quot;    &quot;Arturo&quot;  &quot;Sasha&quot;   &quot;Everett&quot; &quot;Hope&quot;   
 [8] &quot;Arturo&quot;  &quot;Sasha&quot;   &quot;Everett&quot; &quot;Hope&quot;    &quot;Arturo&quot;  &quot;Sasha&quot;   &quot;Everett&quot;
[15] &quot;Hope&quot;    &quot;Arturo&quot; 
rep(firstNames, each = 4)
 [1] &quot;Sasha&quot;   &quot;Sasha&quot;   &quot;Sasha&quot;   &quot;Sasha&quot;   &quot;Everett&quot; &quot;Everett&quot; &quot;Everett&quot;
 [8] &quot;Everett&quot; &quot;Hope&quot;    &quot;Hope&quot;    &quot;Hope&quot;    &quot;Hope&quot;    &quot;Arturo&quot;  &quot;Arturo&quot; 
[15] &quot;Arturo&quot;  &quot;Arturo&quot; </code></pre>
<div class="challenge">
<p>Can you predict what each of the following lines of code will
return?</p>
<pre class="r"><code>c(&quot;Betsy&quot;, firstNames)
firstNames[4:1]
ages[c(2, 4)]
ages[1, 3]
c(firstNames, ages)
rep(firstNames, ages)
rep(ages, firstNames)</code></pre>
<details>
<summary>
<strong>Solution:</strong>
</summary>
<div class="solution">
<pre class="r"><code>c(&quot;Betsy&quot;, firstNames)
[1] &quot;Betsy&quot;   &quot;Sasha&quot;   &quot;Everett&quot; &quot;Hope&quot;    &quot;Arturo&quot; 

firstNames[4:1]
[1] &quot;Arturo&quot;  &quot;Hope&quot;    &quot;Everett&quot; &quot;Sasha&quot;  

ages[c(2, 4)]
[1] 19 17</code></pre>
<pre class="r"><code>ages[1, 3]
Error in ages[1, 3]: incorrect number of dimensions</code></pre>
<p>Why did <code>ages[1, 3]</code> give an error message? Notice that
<code>1, 3</code> is not a vector. In order to select elements 1 and 3
from <code>ages</code> we need to first create a vector containing the
integers 1 and 3: <code>c(1, 3)</code> and then place this inside the
brackets: <code>ages[c(1, 3)]</code>.</p>
<pre class="r"><code>c(firstNames, ages)
[1] &quot;Sasha&quot;   &quot;Everett&quot; &quot;Hope&quot;    &quot;Arturo&quot;  &quot;18&quot;      &quot;19&quot;      &quot;21&quot;     
[8] &quot;17&quot;     </code></pre>
<p>Notice that when we concatenated <code>firstNames</code> and
<code>ages</code> all of the ages turned into text with each number
surrounded by quotes. This is because all elements in a vector must have
the same data type, either numbers or text, but not both. R tried to fix
this by using the data type of the first vector we supplied.</p>
<pre class="r"><code>rep(firstNames, 1:4)
 [1] &quot;Sasha&quot;   &quot;Everett&quot; &quot;Everett&quot; &quot;Hope&quot;    &quot;Hope&quot;    &quot;Hope&quot;    &quot;Arturo&quot; 
 [8] &quot;Arturo&quot;  &quot;Arturo&quot;  &quot;Arturo&quot; 
rep(1:4, firstNames)
Warning: NAs introduced by coercion
Error in rep(1:4, firstNames): invalid &#39;times&#39; argument</code></pre>
<p>The first example repeats each element of firstNames the number of
times given in ages, so “Sasha” is repeated 1 time, “Everett” is
repeated 2 times, etc. The second example causes an error because the
order of arguments is not interchangeable. The first vector provided
must contain the values to be repeated, while the second vector must
contain integers defining the number of times to repeat each value. Use
<code>?rep</code> in the Console to learn more.</p>
</div>
</details>
</div>
<p><br></p>
<p>Vectors are useful because we can use them to do multiple
calculations at once. Adding or multiplying a vector by a scalar applies
the operation to each element of the vector.</p>
<pre class="r"><code>ages + 10</code></pre>
<pre><code>[1] 28 29 31 27</code></pre>
<pre class="r"><code>2 * ages</code></pre>
<pre><code>[1] 36 38 42 34</code></pre>
<pre class="r"><code>ages / 2</code></pre>
<pre><code>[1]  9.0  9.5 10.5  8.5</code></pre>
<p>Arithmetic between two vectors is conducted element by element:</p>
<pre class="r"><code>ages + 1:4</code></pre>
<pre><code>[1] 19 21 24 21</code></pre>
<pre class="r"><code>ages - ages</code></pre>
<pre><code>[1] 0 0 0 0</code></pre>
<pre class="r"><code>ages[1:2] - ages[3:4]</code></pre>
<pre><code>[1] -3  2</code></pre>
<div class="challenge">
<p>Do this math in R</p>
<ol style="list-style-type: decimal">
<li>Calculate the sum of all integers between 1 and 100.</li>
<li>Calculate the difference between the sum of all odd numbers between
1 and 50 and the sum of all even numbers between 1 and 50.</li>
</ol>
<details>
<summary>
<strong>Solution:</strong>
</summary>
<div class="solution">
<p>There are lots of ways to solve this problem. Here is one way.</p>
<pre class="r"><code># Sum of all integers between 1 and 100
sum(1:100)
[1] 5050

# Difference between sum of odds and evens  between 1 and 50
odds &lt;- seq(1, 50, 2) # a vector with all odd numbers
evens &lt;- seq(2, 50, 2) # a vector with all even numbers
sum(odds) - sum(evens) # calculate sum of each vector, then take the difference
[1] -25</code></pre>
</div>
</details>
</div>
<p><br></p>
</div>
</div>
<div id="managing-your-environment" class="section level3">
<h3>Managing your environment</h3>
<p>There are a few useful commands you can use to interact with the R
session.</p>
<p><code>ls</code> will list all of the variables and functions stored
in the global environment (your working R session):</p>
<pre class="r"><code>ls()</code></pre>
<pre><code>[1] &quot;ages&quot;       &quot;evens&quot;      &quot;firstNames&quot; &quot;odds&quot;       &quot;x&quot;         
[6] &quot;y&quot;          &quot;z&quot;         </code></pre>
<p>Note here that we didn’t give any arguments to <code>ls</code>, but
we still needed to give the parentheses to tell R to call the
function.</p>
<p>If we type <code>ls</code> by itself, R prints a bunch of code
instead of a listing of objects.</p>
<pre class="r"><code>ls</code></pre>
<pre><code>function (name, pos = -1L, envir = as.environment(pos), all.names = FALSE, 
    pattern, sorted = TRUE) 
{
    if (!missing(name)) {
        pos &lt;- tryCatch(name, error = function(e) e)
        if (inherits(pos, &quot;error&quot;)) {
            name &lt;- substitute(name)
            if (!is.character(name)) 
                name &lt;- deparse(name)
            warning(gettextf(&quot;%s converted to character string&quot;, 
                sQuote(name)), domain = NA)
            pos &lt;- name
        }
    }
    all.names &lt;- .Internal(ls(envir, all.names, sorted))
    if (!missing(pattern)) {
        if ((ll &lt;- length(grep(&quot;[&quot;, pattern, fixed = TRUE))) &amp;&amp; 
            ll != length(grep(&quot;]&quot;, pattern, fixed = TRUE))) {
            if (pattern == &quot;[&quot;) {
                pattern &lt;- &quot;\\[&quot;
                warning(&quot;replaced regular expression pattern &#39;[&#39; by  &#39;\\\\[&#39;&quot;)
            }
            else if (length(grep(&quot;[^\\\\]\\[&lt;-&quot;, pattern))) {
                pattern &lt;- sub(&quot;\\[&lt;-&quot;, &quot;\\\\\\[&lt;-&quot;, pattern)
                warning(&quot;replaced &#39;[&lt;-&#39; by &#39;\\\\[&lt;-&#39; in regular expression pattern&quot;)
            }
        }
        grep(pattern, all.names, value = TRUE)
    }
    else all.names
}
&lt;bytecode: 0x000001dc4beca120&gt;
&lt;environment: namespace:base&gt;</code></pre>
<p>What’s going on here?</p>
<p>Like everything in R, <code>ls</code> is the name of an object, and
entering the name of an object by itself prints the contents of the
object. The object <code>x</code> that we created earlier contains
0.025:</p>
<pre class="r"><code>x</code></pre>
<pre><code>[1] 0.025</code></pre>
<p>The object <code>ls</code> contains the R code that makes the
<code>ls</code> function work! We’ll talk more about how functions work
and start writing our own later.</p>
<p>You can use <code>rm</code> to delete objects you no longer need:</p>
<pre class="r"><code>rm(x)</code></pre>
<p>If you have lots of things in your environment and want to delete all
of them, you can pass the results of <code>ls</code> to the
<code>rm</code> function:</p>
<pre class="r"><code>rm(list = ls())</code></pre>
<p>In this case we’ve composed the two function (just like in math!).
Like the order of operations, anything inside the innermost parentheses
is evaluated first, and so on.</p>
<p>In this case we’ve specified that the results of <code>ls</code>
should be used for the <code>list</code> argument in <code>rm</code>.
When assigning values to arguments by name, you <em>must</em> use the
<code>=</code> operator and not the <code>&lt;-</code> operator.</p>
<p>If instead we use <code>&lt;-</code>, there will be unintended side
effects, or you may get an error message:</p>
<pre class="r"><code>rm(list &lt;- ls())</code></pre>
<pre><code>Error in rm(list &lt;- ls()): ... must contain names or character strings</code></pre>
<div class="callout-tip">
<p><strong>Warnings vs. Errors</strong></p>
<p>Pay attention when R does something unexpected! Errors, like above,
occur when R cannot proceed with a calculation. Warnings on the other
hand usually mean that the function has run, but it probably hasn’t
worked as expected.</p>
<p>In both cases, the message that R prints out usually give you clues
how to fix a problem.</p>
</div>
<p>Notice that although <code>rm()</code> and <code>ls()</code> are
similar to the shell commands <code>rm</code> and <code>ls</code>, they
operate in different spaces. The Terminal window in RStudio accesses the
file system on your computer. The R Console accesses objects that you
create during a specific R session. Once your close R, these objects
disappear forever; they are not saved on your file system.</p>
</div>
<div id="writing-and-running-code-in-scripts" class="section level3">
<h3>Writing and running code in scripts</h3>
<p>So far we have been typing all of our R code directly into the R
console. The real power of using R is that we can save code into text
files (called <strong>scripts</strong>) that make it easy for anyone to
reproduce your analysis. When saving an R script we will use the file
extension .R to indicate that the contents are written in the R
programming language, but really it is just a text file and can be
opened by any text editor (Word, Notepad, Google Docs, OpenOffice,
TextEdit, etc).</p>
<p>Let’s make our first R script.</p>
<div class="challenge">
<p>Create a new R script.</p>
<ol style="list-style-type: decimal">
<li>Click File &gt; New File &gt; R Script.</li>
<li>The Source panel will open with a blank file like this:</li>
</ol>
<div class="float">
<img src="../fig/01-rstudio-script.png"
alt="RStudio layout with .R file open" />
<div class="figcaption">RStudio layout with .R file open</div>
</div>
<ol start="3" style="list-style-type: decimal">
<li>The file is not yet saved on your computer (notice that its name is
Untitled 1 in the tab at the top of the Source panel.</li>
<li>Save this file to your computer. Click File &gt; Save.</li>
<li>Choose where to save the file on your computer. We recommend
creating a new folder in your workbook named lesson-code and then saving
this script as lesson_01_code.R inside that folder. You do not need to
type .R at the end of the name. The .R file extension will be
automatically added when you click save.</li>
</ol>
</div>
<p>From now onwards, type any code you see in this lesson into the R
script you just created. This will provide a record for you to refer to
and edit later.</p>
<p>We’re going to write an R script that loads a data table from NEON
and do some calculations on values saved in it.</p>
</div>
<div id="reading-data-from-files" class="section level3">
<h3>Reading data from files</h3>
<p>R has functions to read any text-based file. One of the most widely
used formats for text-based data table is the <strong>comma separated
values</strong> (CSV) format, where each row of the table corresponds to
a row of text and values in different columns are separated by commas.
We’ll learn more about best practices for data organization in <a
href="%22chp-spreadsheets.html%22">NA</a>. For now, we will use the
<code>read.csv()</code> function to read a CSV file into a data table in
R. The object that is created by this function is called a <strong>data
frame</strong> and we will learn more about this type of object in <a
href="chp-data-structures.html">Data structures and operations</a>.</p>
<p>Type the following into your new R script:</p>
<pre class="r"><code># Read in a data table with water temperature
watertemp &lt;- read.csv(&quot;data/NEON_water/watertemp_30min_TECR_2021-04_2021-10.csv&quot;)

# View the first few rows
head(watertemp)


# How many rows and columns are there in these data?
nrow(watertemp)
ncol(watertemp)

# What are the names of the columns in this data table
names(watertemp)</code></pre>
<p>Typing text in a R script does not cause the code to run in the R
Console. There are several options for executing code in an R
script:</p>
<ol style="list-style-type: decimal">
<li>Select the code you want to execute by either:
<ul>
<li>highlighting it</li>
<li>placing your cursor on the line that you want to run</li>
</ul></li>
<li>Run the selected code by either:
<ul>
<li>clicking on the Run button in the upper right corner of the Source
window.</li>
<li>type <kbd>Ctrl</kbd>+<kbd>Return</kbd> in Windows or Linux or
<kbd>⌘</kbd>+<kbd>Return</kbd> on OS X.</li>
</ul></li>
</ol>
<p>NOTE: To “run” code measn the same thing as to “execute” code. We can
use the word “run” in informal contexts and “execute” in formal
contexts.</p>
<p>Run each line of code above from your R script.</p>
<p>What happens? Which lines caused output to appear in the Console?</p>
<p>The <code>read.csv()</code> function does not produce any output in
the Console if everything executes correctly. However, if you now look
in the Environment tab, you should see an object named
<code>watertemp</code>.</p>
<p>The <code>head()</code>, <code>nrow()</code>, <code>ncol()</code> and
<code>names()</code> functions are useful ways to learn more about the
size and the contents of the data. You can also see this information in
the Environment window. <code>watertemp</code> has 20544 observations
(or rows) and 10 variables (or columns). If you click on the blue arrow
to the left of the object’s name you will see the names of each of the
columns followed by information about the values contained in each
column. Lastly, clicking on the name of the object causes a new tab to
open in the Source window that shows the data table itself (try it!)</p>
<p>Recall that any line preceded by a <code>#</code> symbol is a
<strong>comment</strong>. Comments are text found in code that are not
executed and do not cause anything to happen. Comments are
<em>extremely</em> important for anyone who will need to read your code
and understand what it is doing (especially your future self!). Get in
the habit of commenting every line or every short section of your code.
It can be useful to include not just details of what the code does, but
also include a header with your name and what the overall goal of the
code is.</p>
<p>For example, add the following to the top of your script:</p>
<pre class="r"><code>## Code from the Introduction to R and RStudio lesson
## Author: YOUR NAME HERE
## Date: TODAYS DATE
## Description: This code loads and explores water temperature data from the Teakettle Lake NEON site</code></pre>
<p>Let’s examine the <code>read.csv()</code> function more carefully. In
the code above we provided the function with a single text argument
containing the path to the data file. Locate this file using the Files
window in RStudio.</p>
<p>What do you think would happen if we changed the code to read:</p>
<pre class="r"><code>read.csv(&quot;watertemp_30min_TECR_2021-04_2021-10.csv&quot;)</code></pre>
<details>
<summary>
<strong>Solution:</strong>
</summary>
<pre><code>Warning in file(file, &quot;rt&quot;): cannot open file
&#39;watertemp_30min_TECR_2021-04_2021-10.csv&#39;: No such file or directory</code></pre>
<pre><code>Error in file(file, &quot;rt&quot;): cannot open the connection</code></pre>
</details>
<p>What does this text mean? It is a warning that the function did not
execute properly. “cannot open the connection” means that R could not
find this file. Why couldn’t R file the file? We didn’t specify the
location of the file relative to the current working directory.</p>
<div id="working-directory" class="section level4">
<h4>Working directory</h4>
<p>Knowing R’s current working directory is important because when you
need to access other files (for example, to import a data file), R will
look for them relative to the current working directory.</p>
<p>Each time you create a new RStudio Project, it will create a new
directory for that project. When you open an existing
<code>.Rproj</code> file, it will open that project and set R’s working
directory to the folder that file is in.</p>
<p>You can check the current working directory with the
<code>getwd()</code> command, or by using the menus in RStudio.</p>
<div class="challenge">
<p>Get and set the working directory in R.</p>
<ol style="list-style-type: decimal">
<li><p>In the console, type <code>getwd()</code> (“wd” is short for
“working directory”) and press Enter.</p></li>
<li><p>In the Files pane, double click on the <code>data</code> folder
to open it (or navigate to any other folder you wish). To get the Files
panel back to the current working directory, click “More” and then
select “Go To Working Directory”.</p></li>
<li><p>You can change the working directory with <code>setwd()</code>,
or by using RStudio menus.</p></li>
<li><p>In the console, type <code>setwd("data")</code> and hit Enter.
Type <code>getwd()</code> and press Enter to see the new working
directory.</p></li>
<li><p>In the menus at the top of the RStudio window, click the
“Session” menu button, and then select “Set Working Directory” and then
“Choose Directory”.</p></li>
<li><p>In the windows navigator that opens, navigate back to the project
directory, and click “Open”. Note that a <code>setwd</code> command will
automatically appear in the console.</p></li>
</ol>
<p>Make sure to set your working directory back to the main
R-course-NEON-workbook folder for the rest of the lesson.</p>
</div>
<div class="callout-tip">
<p>File does not exist errors</p>
<p>When you’re attempting to reference a file in your R code and you’re
getting errors saying the file doesn’t exist, it’s a good idea to first
check your spelling and capitalization and then check your working
directory. You need to either provide an absolute path to the file, or
you need to make sure the file is saved in the working directory (or a
subfolder of the working directory) and provide a relative path.</p>
</div>
</div>
</div>
<div id="introduction-to-data-frames" class="section level3">
<h3>Introduction to data frames</h3>
<p>Data frames are a very common way to work with data tables in R. Each
row of a data frame represents one observation and each column contains
a vector of data about a particular variable. In the
<code>watertemp</code> data frame, each observation is a mean surface
water temperature measurement from <a
href="https://www.neonscience.org/field-sites/tecr">Teakettle Creek</a>
near Fresno, CA. Measurements come from several sensor locations on the
creek and are averaged over the time period defined by the
<code>startDateTime</code> and <code>endDateTime</code> columns.</p>
<p>Let’s explore these data in more detail.</p>
<p>To view the contents of a column, use the <code>$</code> operator to
extract a vector of values:</p>
<pre class="r"><code># View a column
watertemp$surfWaterTempMean</code></pre>
<p>You can do calculations on the values in a column using R’s built-in
functions:</p>
<pre class="r"><code># Calculate the range of values
range(watertemp$surfWaterTempMean)</code></pre>
<pre><code>[1] NA NA</code></pre>
<p>Oops! There must be missing data in this column. Missing values are
denoted by <code>NA</code> and if there are any missing values, R will
not exclude them from its calculations.</p>
<p>To omit missing values before completing a calculation, use the
<code>na.rm = TRUE</code> argument:</p>
<pre class="r"><code># Calculate the range of values excluding missing values
range(watertemp$surfWaterTempMean, na.rm = TRUE)</code></pre>
<pre><code>[1] -2.328 18.645</code></pre>
<div class="challenge">
<ol style="list-style-type: decimal">
<li>Use the <code>mean()</code> function to calculate the average
surface water temperature.</li>
<li>Use the <code>max()</code> and <code>min()</code> functions to
calculate the maximum and minimum surface water temperatures.</li>
</ol>
<details>
<summary>
<strong>Solution:</strong>
</summary>
<div class="solution">
<pre class="r"><code># Calculate the mean surface water temperature
mean(watertemp$surfWaterTempMean, na.rm = TRUE)
[1] 9.949536

# Calculate the max and min surface water temperatures
max(watertemp$surfWaterTempMean, na.rm = TRUE)
[1] 18.645
min(watertemp$surfWaterTempMean, na.rm = TRUE)
[1] -2.328</code></pre>
</div>
</details>
</div>
<p>We can also tabulate values in a column data using the
<code>table()</code> function. This function finds all of the unique
values and counts the number of times each value appears. The
<code>HOR.VER</code> column is a identifier of the location of a
tempereature sensor, so we can use it to determine how many different
sensors are in these data.</p>
<pre class="r"><code># How many observations are from each sensor location?
table(watertemp$HOR.VER)</code></pre>
<pre><code>
101.1 102.1 
10272 10272 </code></pre>
<p>There are two sensors (101.1 and 101.2) and each has 10272
observations in this data table.</p>
<p>The <code>finalQF</code> column is a quality-control variable that
indicates whether data are acceptable for use. Let’s determine whether
all observations in these data are acceptable and have a value of 0 in
the <code>finalQF</code> column.</p>
<div class="challenge">
<p>Use the <code>table()</code> function to determine how many
observations in this data table should not be used for analysis.</p>
<details>
<summary>
<strong>Solution:</strong>
</summary>
<div class="solution">
<pre class="r"><code># Tabulate the quality-control flag column
table(watertemp$finalQF)</code></pre>
<pre><code>
    0     1 
19919   625 </code></pre>
<p>It looks like 625 observations had a quality flag = 1, so if we were
to use these data, we should read the documentation to learn what that
means and if these data should be omitted from the analysis.</p>
</div>
</details>
</div>
<p>Columns in a dataframe are vectors and we can do math with them in
the same way that we would do math with other numeric vectors:</p>
<pre class="r"><code># Add the expected uncertainty to the mean water temperature
# and save it to a variable called temp_upperbound
temp_upperbound &lt;- watertemp$surfWaterTempMean + watertemp$surfWaterTempExpUncert

# View the first 5 values in temp_upperbound
temp_upperbound[1:5]
[1] 4.308 4.184 3.992 3.785 3.606</code></pre>
<div class="challenge">
<p>Calculate a lower temperature bound for each observation by
subtracting the expected uncertainty from the mean temperature.</p>
<details>
<summary>
<strong>Solution:</strong>
</summary>
<div class="solution">
<pre class="r"><code># Calculate a lower bound
temp_lowerbound &lt;- watertemp$surfWaterTempMean - watertemp$surfWaterTempExpUncert</code></pre>
</div>
</details>
</div>
<p>The data in the <code>watertemp</code> data frame provide a time
series of surface water temperature in Teakettle Creek that likely
fluctuates throughout the year. If we want to analyze or visualize this
time series, we need a way to work with the dates as actual numeric
values, rather than as text.</p>
<p>Base R has functions for working with dates and times, but they are
tricky to learn. We’re going to install a widely used package called
<code>lubridate</code> to work with the dates and times saved in the
<code>startDateTime</code> and <code>endDateTime</code> columns.</p>
</div>
<div id="installing-and-loading-packages" class="section level3">
<h3>Installing and loading packages</h3>
<p>“base” R is the functionality that comes installed with R, but the
powerful thing about R is its user community who have created thousands
of <strong>packages</strong> that increase its functionality. As of this
writing, there are nearly 20,000 packages available on <a
href="https://cran.r-project.org/">CRAN</a> (the comprehensive R archive
network).</p>
<p>Packages can be viewed, loaded, and detached in the Packages tab of
the lower right panel in RStudio. Clicking on this tab will display all
of the installed packages with a checkbox next to them. If there is
nothing listed then you do not have any packages installed. Packages can
be installed and updated from the Package tab with the Install and
Update buttons at the top of the tab.</p>
<p>Let’s install the <code>lubridate</code> package. Click the Install
button. In the pop-up that appears, type <code>lubridate</code>. Do not
change any of the other settings, then click Install.</p>
<p>Notice what happens in the R Console.</p>
<p>Instead of clicking the Install button, we could have installed this
packages by typing <code>install.packages("lubridate")</code> into the
Console.</p>
<p>Now this package should appear in the list of installed packages with
an empty checkbox next to it. The empty checkbox indicates that the
package is not <strong>loaded</strong> yet in this R session. That means
we cannot use the functions in it yet. You can load and unload packages
by clicking on the box next to them. Notice what happens in the Console
when you check and uncheck the box next to <code>lubridate</code>:</p>
<ul>
<li>You can make a package available for use in your R session with
<code>library(packagename)</code>.</li>
<li>You can make a previously loaded package unavailable in your R
session with <code>detach("packagename", unload = TRUE)</code>. This is
sometimes necessary if two packages are using the same name for a
function.</li>
</ul>
<div class="callout-important">
<p>Packages only need to be installed <strong>once</strong>. This saves
the package to a location on your computer that R can access.</p>
<p>You need to load packages <strong>every time</strong> you open a new
R session, if you want to be able to use the functions in them.</p>
</div>
<div class="challenge">
<p>Write a line of code in your new R script that will load the
<code>lubridate</code> package.</p>
<details>
<summary>
<strong>Solution:</strong>
</summary>
<div class="solution">
<p>We can use the <code>library()</code> command load a packages. Notice
that the name of the packages <strong>is not</strong> inside quotation
marks. This is different from the <code>install.packages()</code>
function, where the package name must be quoted.</p>
<pre class="r"><code># Load the lubridate package
library(lubridate)</code></pre>
<pre><code>
Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>The following objects are masked from &#39;package:base&#39;:

    date, intersect, setdiff, union</code></pre>
</div>
</details>
</div>
<p><br></p>
<div class="callout-trick">
<p>Getting Help with Packages</p>
<p>Many packages come with “vignettes”: tutorials and extended example
documentation. Without any arguments, <code>vignette()</code> will list
all vignettes for all installed packages;
<code>vignette(package="package-name")</code> will list all available
vignettes for <code>package-name</code>, and
<code>vignette("vignette-name")</code> will open the specified
vignette.</p>
<p>If a package doesn’t have any vignettes, you can usually find help by
typing <code>help("package-name")</code>.</p>
<p>RStudio also has a set of excellent <a
href="https://rstudio.com/resources/cheatsheets/">cheatsheets</a> for
many packages.</p>
</div>
</div>
<div id="putting-it-all-together" class="section level3">
<h3>Putting it all together</h3>
<p>Let’s use what we have learned to make a graph showing how surface
water temperature changes over time in Teakettle Creek.</p>
<p>To do this we first need to convert the text in the
<code>startDateTime</code> column to a format that R can interpret as
have numerical values.</p>
<pre class="r"><code># Convert the text to a date and time
# This replaces the existing startDateTime column
# ymd_hms() comes from the lubridate package
watertemp$startDateTime &lt;- ymd_hms(watertemp$startDateTime)</code></pre>
<p>Now that R knows these values are times, we can do much more with
them:</p>
<pre class="r"><code># View the date component of each value (but only from rows 1 - 10)
date(watertemp$startDateTime)[1:10]
 [1] &quot;2021-04-01&quot; &quot;2021-04-01&quot; &quot;2021-04-01&quot; &quot;2021-04-01&quot; &quot;2021-04-01&quot;
 [6] &quot;2021-04-01&quot; &quot;2021-04-01&quot; &quot;2021-04-01&quot; &quot;2021-04-01&quot; &quot;2021-04-01&quot;

# What was the most recent date that data were recorded in this data set?
max(date(watertemp$startDateTime))
[1] &quot;2021-10-31&quot;


# What was the earliest date that data were recorded in this data set?
min(date(watertemp$startDateTime))
[1] &quot;2021-04-01&quot;</code></pre>
<p>We can also use the <code>plot()</code> function to make a
scatterplot if we specify which values should be the <code>x</code>
coordinate and which should be the <code>y</code> coordinate:</p>
<pre class="r"><code># Plot the mean temperature over time
plot(x = watertemp$startDateTime, y = watertemp$surfWaterTempMean)</code></pre>
<p><img src="images/rmd-02-unnamed-chunk-71-1.png" width="816" style="display: block; margin: auto;" /></p>
<div class="callout-tip">
<p>Here’s another way to make this same graph, which follows the format:
<code>plot(y ~ x, data = dataframename)</code>:</p>
<pre class="r"><code>plot(surfWaterTempMean ~ startDateTime, data = watertemp)</code></pre>
<p><img src="images/rmd-02-unnamed-chunk-72-1.png" width="816" style="display: block; margin: auto;" /></p>
</div>
<p>In R there are usually many ways to write code that does the same
thing. In general, the best choice is usually the one that is easiest to
read and which involves the least repetition. Which version do you think
is better here?</p>
<p>Similarly, if we are working with several columns in the same data
frame, the <code>with()</code> function can make code much more
efficient and readable:</p>
<pre class="r"><code># Calculate the upper and lower bounds on temperature using the
# mean and expected uncertainty columns in the watertemp data frame
temp_upperbound &lt;- with(watertemp, surfWaterTempMean + surfWaterTempExpUncert)
temp_lowerbound &lt;- with(watertemp, surfWaterTempMean - surfWaterTempExpUncert)

# Print the first 10 values of each of these vectors
temp_upperbound[1:10]</code></pre>
<pre><code> [1] 4.308 4.184 3.992 3.785 3.606 3.447 3.311 3.210 3.122 3.045</code></pre>
<pre class="r"><code>temp_lowerbound[1:10]</code></pre>
<pre><code> [1] 4.032 3.908 3.716 3.509 3.330 3.171 3.035 2.934 2.846 2.769</code></pre>
<p>Now that you have written your first R script it is time to save your
work! Click on the save icon at the top of the Source panel.</p>
<div class="callout-important">
<p><strong>R does not auto-save.</strong> Be sure to save your work
often when you are working. Consider setting a timer to remind yourself
to do this.</p>
</div>
<p>Close your R script by clicking on the small x on the tab next to the
name of the script at the top of the Source panel. You can reopen the
script using the File &gt; Open File menus option at the top of the
RStudio window or by clicking on the name of the script file in the
Files panel.</p>
</div>
<div id="getting-help" class="section level3">
<h3>Getting help</h3>
<p>One of the most daunting aspects of R is the large number of
functions available. It would be prohibitive, if not impossible to
remember the correct usage for every function you use. Luckily, using
the help files means you don’t have to remember that!</p>
<p>R, and every package, provide help files for functions. The general
syntax to search for help on any function, “function_name”, from a
specific function that is in a package loaded into the R session is:</p>
<pre class="r"><code>?function_name
help(function_name)</code></pre>
<p>For example take a look at the help file for <code>read.csv()</code>
which we used previously to read data into R.</p>
<pre class="r"><code>?read.csv()</code></pre>
<p>This will load up a help page in RStudio. Each help page is broken
down into sections:</p>
<ul>
<li>Description: An extended description of what the function does.</li>
<li>Usage: The arguments of the function and their default values (which
can be changed).</li>
<li>Arguments: An explanation of the data each argument is
expecting.</li>
<li>Details: Any important details to be aware of.</li>
<li>Value: The data the function returns.</li>
<li>See Also: Any related functions you might find useful.</li>
<li>Examples: Some examples for how to use the function.</li>
</ul>
<p>Different functions might have different sections, but these are the
main ones you should be aware of.</p>
<p>Notice how related functions might call for the same help file. This
is because these functions have very similar applicability and often
share the same arguments as inputs to the function, so package authors
often choose to document them together in a single help file. From the
help file for <code>read.csv</code> we can see that this function is
actually a specific version of <code>read.table</code> where a few
default arguments are set to match the format of a csv file
(<code>header = TRUE</code> and <code>sep = ","</code>).</p>
<pre class="r"><code>?write.table()
?write.csv()</code></pre>
<div class="callout-tip">
<p>Running Examples</p>
<p>From within the function help page, you can highlight code in the
Examples and type <kbd>Ctrl</kbd>+<kbd>Return</kbd> to run it in RStudio
console. This gives you a quick way to get a feel for how a function
works.</p>
</div>
<p>Don’t worry about trying to remember the name of every function in R.
You can look them up on Google, or if you can remember the start of the
function’s name, use the tab completion in RStudio. This is one
advantage that RStudio has over R on its own, it has auto-completion
abilities that allow you to more easily look up functions, their
arguments, and the values that they take.</p>
</div>
</div>
<div id="exercises" class="section level2">
<h2>Exercises</h2>
<p>After completing these exercises, learners will be able to use R and
RStudio to:</p>
<ol style="list-style-type: decimal">
<li>execute simple mathematical calculations</li>
<li>assign and manipulate variables</li>
<li>assign, subset and manipulate data in a vector</li>
<li>execute vector algebra</li>
<li>write and save a code script</li>
<li>write comments in a code script</li>
<li>read a data table from a file</li>
<li>access and understand a function’s documentation page</li>
</ol>
<p><strong>2.1</strong> Create a new R script that loads water quality
data from the Teakettle Creek NEON site. These data are in a CSV file
named waterqual_inst_TECR_2021-04_2021-10.csv in the NEON_water folder
in the data directory. Write your code as if the working directory is
the main R-course-NEON-workbook project folder. Save your script as
2.1.R in the completed exercises folder.</p>
<ol style="list-style-type: decimal">
<li>How many rows are in this data table?</li>
<li>Name two columns in this data table.</li>
</ol>
<p><strong>2.2</strong> Create a new R script that contains the
following code. Write comments that describe what each line of code
below does (be specific). Write a header comment at the top of your
script that includes a title, author, date and brief description of what
the script does. Save your script as 2.2.R in the completed exercises
folder.</p>
<pre class="r"><code>library(lubridate)

nitrate &lt;- read.csv(&quot;data/NEON_water/nitrate_15min_TECR_2021-04_2021-10.csv&quot;)

nitrate$startDateTime &lt;- ymd_hms(nitrate$startDateTime)
nitrate$endDateTime &lt;- ymd_hms(nitrate$endDateTime)

nitrate$day &lt;- with(nitrate, date(startDateTime))

table(nitrate$day)</code></pre>
<p><strong>2.3</strong> Adapt the code in exercise 2 so that you can
determine whether every observation in the <code>nitrate</code> data
frame is based on a 30-minute time period average.</p>
<p>HINT: You will need to calculate the difference in time between the
start and end dates.</p>
<p><strong>2.4</strong> Run these two commmands and then look at the
help for the <code>paste</code> function.</p>
<p><code>paste(1:5, 6:10, sep = "-")</code></p>
<p><code>paste(1:10, collapse = "-")</code></p>
<ol style="list-style-type: decimal">
<li>How many elements are in each of the vectors returned by these two
commands?</li>
<li>Use the information in the help file to explain why these commands
yield different results.</li>
</ol>
<p><strong>2.5</strong> Write code that accomplishes the following: 1.
Calculate the average of all even numbers from 1 to 100 and assign this
value to a variable. 2. Calculate the average of all odd numbers from 1
to 100 and assign this value to a different variable. 3. Calculate the
difference between the two variables you created (i.e. subtract
them).</p>
<p><strong>2.6</strong> Modify the script you created in this lesson so
that is does the following:</p>
<ol style="list-style-type: decimal">
<li>Calculate the difference between the maximum of
<code>temp_upperbound</code> and the minimum of
<code>temp_lowerbound</code>.</li>
<li>Calculate a vector containing the difference between
<code>temp_lowerbound</code> and <code>temp_upperbound</code>.</li>
<li>Print only the even numbered elements of the vector you created in
step 2 (e.g. elements 2, 4, 6, etc.).</li>
</ol>
<p><strong>2.7</strong> Write R code that calculates:</p>
<ol style="list-style-type: decimal">
<li>The area of a circle with radius = 5. HINT: The variable
<code>pi</code> contains the value of the number pi. Type
<code>pi</code> into the console to see this.</li>
<li>The area of circles with radii = to the numbers 1 through 100.</li>
<li>The average of the areas of the 100 circles calculated in step
2.</li>
</ol>
<p><strong>2.8</strong> Use the following code to answer the
questions:</p>
<pre class="r"><code>dogs &lt;- c(&quot;Alphie&quot;, &quot;Boo&quot;, &quot;Carter&quot;)

cats &lt;- c(&quot;Donut&quot;, &quot;Edgar&quot;, &quot;Felix&quot;)</code></pre>
<p>Write one line of code for each of the following:</p>
<ol style="list-style-type: decimal">
<li>Select the second name in <code>dogs</code>.</li>
<li>Replace the first and third names in <code>cats</code> with a value
that indicates the data are missing.</li>
</ol>
</div>
<div id="sources-and-resources" class="section level2">
<h2>Sources and Resources</h2>
<p>This lesson was adapted from <a
href="https://swcarpentry.github.io/r-novice-gapminder/"><span
class="citation">Zimmerman et al. (2019)</span></a> episodes 1 and 3 by
Jes Coyle.</p>
<p>This lesson utilizes data from <span class="citation">National
Ecological Observatory Network (NEON) (2023a)</span> and <span
class="citation">National Ecological Observatory Network (NEON)
(2023b)</span>.</p>
<div id="additional-resources" class="section level3">
<h3>Additional Resources</h3>
<ul>
<li><a
href="https://support.posit.co/hc/en-us/categories/200098757-Learn-R">Learn
R by Posit</a></li>
<li><a href="https://www.youtube.com/watch?v=kfcX5DEMAp4">#RYouWithMe:
Basic Basics Lesson 1: An Opinionated Tour of RStudio</a></li>
<li><a href="http://www.statmethods.net/">Quick R</a></li>
<li><a href="http://www.rstudio.com/resources/cheatsheets/">RStudio
cheat sheets</a></li>
<li><a href="http://www.cookbook-r.com/">Cookbook for R</a></li>
<li>Read more about using the Source window to edit and execute code <a
href="https://support.posit.co/hc/en-us/articles/200484448-Editing-and-Executing-Code-in-the-RStudio-IDE">here</a>.</li>
</ul>
</div>
<div id="cited-references" class="section level3">
<h3>Cited References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-NEON-soilCO2" class="csl-entry">
National Ecological Observatory Network (NEON). 2023a. <span>“Soil CO2
Concentration (DP1.00095.001).”</span> National Ecological Observatory
Network (NEON). <a
href="https://doi.org/10.48443/BDGB-5V03">https://doi.org/10.48443/BDGB-5V03</a>.
</div>
<div id="ref-NEON-soiltemp" class="csl-entry">
———. 2023b. <span>“Soil Temperature (DP1.00041.001).”</span> National
Ecological Observatory Network (NEON). <a
href="https://doi.org/10.48443/9G10-EP60">https://doi.org/10.48443/9G10-EP60</a>.
</div>
<div id="ref-swc-reproducible-lesson" class="csl-entry">
Zimmerman, Naupaka, Greg Wilson, Raniere Silva, Scott Ritchie, François
Michonneau, Jeffrey Oliver, Harriet Dashnow, et al. 2019. <span>“<span
class="nocase">swcarpentry/r-novice-gapminder: Software Carpentry: R for
Reproducible Scientific Analysis, June 2019</span>.”</span> Zenodo. <a
href="https://doi.org/10.5281/zenodo.3265164">https://doi.org/10.5281/zenodo.3265164</a>.
</div>
</div>
<!-- javascript that formats solution blocks clickable hidden text -->
</div>
</div>
</div>

<hr>
<p>Introduction to Computing in R with NEON</p>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
